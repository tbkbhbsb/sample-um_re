<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
    "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="um_tbkbhbsb.domain.repository.UserTableRepository">

	<!-- <resultMap type="UserTable" id="UserTableResultMap"> <id column="userId" 
		property="userId"/> <result column="name" property="name" /> <result column="birthday" 
		property="birthday" /> <result column="address" property="address" /> <result 
		column="tel" property="tel" /> <result column="password" property="password" 
		/> <result column="state" property="state" /> </resultMap> -->
	<!-- resultMap="UserTableResultMap" -->


	<select id="findOneByUserId" parameterType="String" resultType="UserTable">
	
    <![CDATA[
        SELECT
        	userId,
			name,
			birthday,
			address,
			tel,
			password,
			state,
			lastUpdate
        FROM
            UserTable
        WHERE
            userId = #{userId}
    ]]>

	</select>

	<insert id="createOneUser" parameterType="UserTable">
		<![CDATA[
	        INSERT INTO UserTable
	        	(
	        	userId,
				name,
				birthday,
				address,
				tel,
				password,
				state,
				lastUpdate
				)
	        VALUES
	        	(
	        	#{userId},
				#{name},
				#{birthday},
				#{address},
				#{tel},
				#{password},
				#{state},
				#{lastUpdate}
	        	)
	           
    ]]>

	</insert>

<!-- UserTable JOIN RoleTable ON UserTable.userId = RoleTable.userId -->
<!-- UserTable LEFT OUTER JOIN RoleTable USING(UserTable.userId) -->

	<select id="searchUserByAndQuery" parameterType="um_tbkbhbsb.domain.Form.SearchForm"
		resultType="um_tbkbhbsb.domain.Form.SearchForm">
		
        SELECT
        	UserTable.userId,
			name,
			birthday,
			address,
			tel,
			state,
			role
        FROM
            UserTable JOIN RoleTable ON UserTable.userId = RoleTable.userId
        <where>
        	<if test="userId != null and userId !=''">
	        	AND
	        	UserTable.userId = #{userId}
    		</if>
    		<if test="name != null and name !=''">
	        	AND
	        	name = #{name} 
    		</if>
    		<if test="birthday != null and birthday !=''">
	        	AND
	        	birthday = #{birthday}
    		</if>
    		<if test="address != null and address !=''">
	        	AND
	        	address = #{address}
    		</if>
    		<if test="tel != null and tel !=''">
	        	AND
	        	tel = #{tel}
    		</if>
    		<if test="state != null and state !=''">
	        	AND
	        	state = #{state}
    		</if>
    		<if test="role != null  and role !=''">
	        	AND
	        	role = #{role}
    		</if>
    	</where>
    ORDER BY
        UserTable.userId
    
	</select>

</mapper>
